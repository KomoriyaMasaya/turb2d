import matplotlib

matplotlib.use('Agg')

import matplotlib.pyplot as plt


def plot_result(self, filename):
    """Plot calculation results with topography

    """

    plt.clf()

    imshow_grid(
        self.grid,

        # 'flow__depth',
        'bed__thickness',
        cmap='PuBu',
        grid_units=('m', 'm'),
        var_name='bed thickness',
        var_units='m',

        # vmin=0,

        # vmax=0.01,
    )

    z = self.grid.at_node['topographic__elevation']

    elev = self.grid.node_vector_to_raster(z)

    cs = plb.contour(
        elev,
        np.arange(min(z), max(z), 10),
        colors='dimgray',
        extent=[0, self.grid.grid_xdimension, 0, self.grid.grid_ydimension])

    cs.clabel(inline=True, fmt='%1i', fontsize=10)

    plt.savefig(filename)
